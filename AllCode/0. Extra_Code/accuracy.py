import pandas as pd

# Load the CSV file into a DataFrame
data = pd.read_csv(r'G:\new_malware_json_zip\split_data\adware_similarity_matrix.csv', sep=',')

# Add the "label" column based on conditions
def assign_label(row):
    if row['adware_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and row['adware_unique_bigrams.csv'] > row['virus_unique_bigrams.csv']:
        return 'adware'
    elif row['spyware_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and row['spyware_unique_bigrams.csv'] > row['virus_unique_bigrams.csv']:
        return 'spyware'
    elif row['virus_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and row['virus_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv']:
        return 'virus'
    else:
        return ''

data['label'] = data.apply(assign_label, axis=1)

# Drop rows where all 2nd, 3rd, and 4th columns are zero
data = data[~((data['adware_unique_bigrams.csv'] == 0) & (data['spyware_unique_bigrams.csv'] == 0) & (data['virus_unique_bigrams.csv'] == 0))]

# Save the DataFrame to a new CSV file
data.to_csv(r'G:\new_malware_json_zip\split_data\classify.csv', index=False, sep=',')
