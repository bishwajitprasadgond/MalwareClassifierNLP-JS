# -*- coding: utf-8 -*-
"""
Created on Tue Jan 30 13:26:45 2024

@author: BISHWAJIT
"""

import pandas as pd

# Read the CSV file into a DataFrame
df = pd.read_csv(r'C:\Unique_Unigram\malware.csv')

# List of allowed function prefixes
allowed_function_prefixes = [
    'LdrGetProcedureAddress',
    'LdrGetDllHandle',
    'LoadResource',
    'FindResourceExW',
    'LdrLoadDll',
    'GetSystemInfo',
    'LoadStringA',
    'NtProtectVirtualMemory',
    'GetSystemMetrics',
    'CryptAcquireContextW',
    'LoadLibraryExW',
    'LocalAlloc',
    'GetProcAddress',
    'GetSystemMetrics',
    'GetVersionExW',
    'GetModuleHandleW',
    'CreateFileW',
    'RegisterClipboardFormatW',
    'LoadLibraryW',
    'MapViewOfFileEx'
]

# Filter rows based on the allowed function prefixes
filtered_df = df[df['Unigram'].apply(lambda x: any(x.startswith(prefix) for prefix in allowed_function_prefixes))]

# Save the new DataFrame to a new CSV file
filtered_df.to_csv(r'C:\Unique_Unigram\filtered_malware.csv', index=False)
