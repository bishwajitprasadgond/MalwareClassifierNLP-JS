import os
import pandas as pd

# Input folder path containing CSV files
input_folder =  r'D:\Malware\unigram_analysis\0test' # Replace with the path to your output folder

# Output file path to store the merged unique rows
output_csv_file = r'D:\Malware\unigram_analysis\0test\adware_unigram_unique.csv'  # Replace with the desired output file path

# Initialize an empty DataFrame to store unique rows
unique_rows_df = pd.DataFrame()

# Check if the input folder exists
if os.path.exists(input_folder):
    # Iterate through the CSV files in the input folder
    for filename in os.listdir(input_folder):
        if filename.endswith('.csv'):
            csv_file_path = os.path.join(input_folder, filename)
            
            # Read the CSV file into a DataFrame
            df = pd.read_csv(csv_file_path)
            
            # Append the unique rows to the DataFrame
            unique_rows_df = pd.concat([unique_rows_df, df]).drop_duplicates().reset_index(drop=True)

    # Save the merged unique rows to a new CSV file
    unique_rows_df.to_csv(output_csv_file, index=False)
    
    print(f"Unique rows merged and saved in '{output_csv_file}'.")
else:
    print(f"The input folder '{input_folder}' does not exist.")
