# -*- coding: utf-8 -*-
"""
Created on Sun Oct  8 12:04:27 2023

@author: bishwajit
"""
import os
import pandas as pd

# Specify the directory containing your .txt files
txt_directory = r'G:\new_malware_json_zip\split_data\spyware\api_name_arguments2'

# Specify the full path for saving the CSV file
csv_filename = r'G:\new_malware_json_zip\split_data\spyware\apidata.csv'  # Update with your desired CSV file path

# Create an empty list to store the text data and labels
data = []
labels = []

# Iterate through the files in the directory
for filename in os.listdir(txt_directory):
    if filename.endswith('.txt'):
        # Extract the label or class name from the filename
        label = filename.split('_')[0]  # Assuming the label is before the first underscore
        labels.append(label)

        # Read the text data from the file
        with open(os.path.join(txt_directory, filename), 'r', encoding='utf-8') as file:
            text = file.read()
            data.append(text)

# Create a DataFrame from the data and labels
df = pd.DataFrame({'text': data, 'labels': labels})

# Save the DataFrame to the specified CSV file path with an escape character
df.to_csv(csv_filename, index=False, escapechar='\\')

print(f"CSV file '{csv_filename}' created with {len(df)} samples.")

