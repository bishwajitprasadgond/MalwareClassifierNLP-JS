# -*- coding: utf-8 -*-
"""
Created on Wed Oct 11 19:52:31 2023

@author: bishwajit
"""


import pandas as pd

# Load the CSV files into DataFrames
adware_data = pd.read_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\adware.csv', sep=',')
trojan_data = pd.read_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\trojan.csv', sep=',')
worm_data = pd.read_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\worm.csv', sep=',')
downloader_data = pd.read_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\downloader.csv', sep=',')
backdoor_data = pd.read_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\backdoor.csv', sep=',')
spyware_data = pd.read_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\spyware.csv', sep=',')
benign_data = pd.read_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\benign.csv', sep=',')
# Add the "label" column based on conditions

def assign_label(row):
    if (
        (row['adware_unique_bigrams.csv'] > 0.0 or
        row['spyware_unique_bigrams.csv'] > 0.0 or
        row['virus_unique_bigrams.csv'] > 0.0 or
        row['trojan_unique_bigrams.csv'] > 0.0 or
        row['worm_unique_bigrams.csv'] > 0.0 or
        row['downloader_unique_bigrams.csv'] > 0.0 or
        row['backdoor_unique_bigrams.csv'] > 0.0 or
        row['benign_unique_bigrams.csv'] > 0.0
        )
    ):
        if (
            row['adware_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and
            row['adware_unique_bigrams.csv'] > row['virus_unique_bigrams.csv'] and
            row['adware_unique_bigrams.csv'] > row['trojan_unique_bigrams.csv'] and
            row['adware_unique_bigrams.csv'] > row['worm_unique_bigrams.csv'] and
            row['adware_unique_bigrams.csv'] > row['downloader_unique_bigrams.csv'] and
            row['adware_unique_bigrams.csv'] > row['backdoor_unique_bigrams.csv'] and
            row['adware_unique_bigrams.csv'] > row['benign_unique_bigrams.csv']
        ):
            return 'adware'
        elif (
            row['spyware_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and
            row['spyware_unique_bigrams.csv'] > row['virus_unique_bigrams.csv'] and
            row['spyware_unique_bigrams.csv'] > row['trojan_unique_bigrams.csv'] and
            row['spyware_unique_bigrams.csv'] > row['worm_unique_bigrams.csv'] and
            row['spyware_unique_bigrams.csv'] > row['downloader_unique_bigrams.csv'] and
            row['spyware_unique_bigrams.csv'] > row['backdoor_unique_bigrams.csv'] and
            row['spyware_unique_bigrams.csv'] > row['benign_unique_bigrams.csv']
        ):
            return 'spyware'
        elif (
            row['virus_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and
            row['virus_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and
            row['virus_unique_bigrams.csv'] > row['trojan_unique_bigrams.csv'] and
            row['virus_unique_bigrams.csv'] > row['worm_unique_bigrams.csv'] and
            row['virus_unique_bigrams.csv'] > row['downloader_unique_bigrams.csv'] and
            row['virus_unique_bigrams.csv'] > row['backdoor_unique_bigrams.csv'] and
            row['virus_unique_bigrams.csv'] > row['benign_unique_bigrams.csv']
        ):
            return 'virus'
        elif (
            row['trojan_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and
            row['trojan_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and
            row['trojan_unique_bigrams.csv'] > row['virus_unique_bigrams.csv'] and
            row['trojan_unique_bigrams.csv'] > row['worm_unique_bigrams.csv'] and
            row['trojan_unique_bigrams.csv'] > row['downloader_unique_bigrams.csv'] and
            row['trojan_unique_bigrams.csv'] > row['backdoor_unique_bigrams.csv'] and
            row['trojan_unique_bigrams.csv'] > row['benign_unique_bigrams.csv']
        ):
            return 'trojan'
        elif (
            row['worm_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and
            row['worm_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and
            row['worm_unique_bigrams.csv'] > row['virus_unique_bigrams.csv'] and
            row['worm_unique_bigrams.csv'] > row['trojan_unique_bigrams.csv'] and
            row['worm_unique_bigrams.csv'] > row['downloader_unique_bigrams.csv'] and
            row['worm_unique_bigrams.csv'] > row['backdoor_unique_bigrams.csv'] and
            row['worm_unique_bigrams.csv'] > row['benign_unique_bigrams.csv']
        ):
            return 'worm'
        elif (
            row['downloader_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and
            row['downloader_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and
            row['downloader_unique_bigrams.csv'] > row['virus_unique_bigrams.csv'] and
            row['downloader_unique_bigrams.csv'] > row['trojan_unique_bigrams.csv'] and
            row['downloader_unique_bigrams.csv'] > row['worm_unique_bigrams.csv'] and
            row['downloader_unique_bigrams.csv'] > row['backdoor_unique_bigrams.csv'] and
            row['downloader_unique_bigrams.csv'] > row['benign_unique_bigrams.csv']
        ):
            return 'downloader'
        elif (
            row['backdoor_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and
            row['backdoor_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and
            row['backdoor_unique_bigrams.csv'] > row['virus_unique_bigrams.csv'] and
            row['backdoor_unique_bigrams.csv'] > row['trojan_unique_bigrams.csv'] and
            row['backdoor_unique_bigrams.csv'] > row['worm_unique_bigrams.csv'] and
            row['backdoor_unique_bigrams.csv'] > row['downloader_unique_bigrams.csv'] and
            row['backdoor_unique_bigrams.csv'] > row['benign_unique_bigrams.csv']
        ):
            return 'backdoor'
        elif (
            row['benign_unique_bigrams.csv'] > row['adware_unique_bigrams.csv'] and
            row['benign_unique_bigrams.csv'] > row['spyware_unique_bigrams.csv'] and
            row['benign_unique_bigrams.csv'] > row['virus_unique_bigrams.csv'] and
            row['benign_unique_bigrams.csv'] > row['trojan_unique_bigrams.csv'] and
            row['benign_unique_bigrams.csv'] > row['worm_unique_bigrams.csv'] and
            row['benign_unique_bigrams.csv'] > row['downloader_unique_bigrams.csv'] and
            row['benign_unique_bigrams.csv'] > row['backdoor_unique_bigrams.csv']
        ):
            return 'benign'
    else:
        return ''

# Assign labels for each DataFrame
adware_data['label'] = adware_data.apply(assign_label, axis=1)
trojan_data['label'] = trojan_data.apply(assign_label, axis=1)
worm_data['label'] = worm_data.apply(assign_label, axis=1)
downloader_data['label'] = downloader_data.apply(assign_label, axis=1)
backdoor_data['label'] = backdoor_data.apply(assign_label, axis=1)
spyware_data['label'] = spyware_data.apply(assign_label, axis=1)
benign_data['label'] = benign_data.apply(assign_label, axis=1)

# Drop rows where 'label' is empty
adware_data = adware_data[adware_data['label'] != '']
trojan_data = trojan_data[trojan_data['label'] != '']
worm_data = worm_data[worm_data['label'] != '']
downloader_data = downloader_data[downloader_data['label'] != '']
backdoor_data = backdoor_data[backdoor_data['label'] != '']
spyware_data = spyware_data[spyware_data['label'] != '']
benign_data = benign_data[benign_data['label'] != '']
# Drop rows where all columns related to unique bigrams are zero
adware_data = adware_data[
    ~(
        (
            (adware_data['adware_unique_bigrams.csv'] == 0.0).all() and
            (adware_data['spyware_unique_bigrams.csv'] == 0.0).all() and
            (adware_data['virus_unique_bigrams.csv'] == 0.0).all() and
            (adware_data['trojan_unique_bigrams.csv'] == 0.0).all() and
            (adware_data['worm_unique_bigrams.csv'] == 0.0).all() and
            (adware_data['downloader_unique_bigrams.csv'] == 0.0).all() and
            (adware_data['backdoor_unique_bigrams.csv'] == 0.0).all() and
            (adware_data['benign_unique_bigrams.csv'] == 0.0).all()
            
        )
    )
]


trojan_data = trojan_data[
    ~(
        (
            (trojan_data['adware_unique_bigrams.csv'] == 0.0).all() and
            (trojan_data['spyware_unique_bigrams.csv'] == 0.0).all() and
            (trojan_data['virus_unique_bigrams.csv'] == 0.0).all() and
            (trojan_data['trojan_unique_bigrams.csv'] == 0.0).all() and
            (trojan_data['worm_unique_bigrams.csv'] == 0.0).all() and
            (trojan_data['downloader_unique_bigrams.csv'] == 0.0).all() and
            (trojan_data['backdoor_unique_bigrams.csv'] == 0.0).all() and
            (trojan_data['benign_unique_bigrams.csv'] == 0.0).all()
        )
    )
]

worm_data = worm_data[
    ~(
        (
            (worm_data['adware_unique_bigrams.csv'] == 0.0).all() and
            (worm_data['spyware_unique_bigrams.csv'] == 0.0).all() and
            (worm_data['virus_unique_bigrams.csv'] == 0.0).all() and
            (worm_data['trojan_unique_bigrams.csv'] == 0.0).all() and
            (worm_data['worm_unique_bigrams.csv'] == 0.0).all() and
            (worm_data['downloader_unique_bigrams.csv'] == 0.0).all() and
            (worm_data['backdoor_unique_bigrams.csv'] == 0.0).all() and
            (worm_data['benign_unique_bigrams.csv'] == 0.0).all()
        )
    )
]

downloader_data = downloader_data[
    ~(
        (
            (downloader_data['adware_unique_bigrams.csv'] == 0.0).all() and
            (downloader_data['spyware_unique_bigrams.csv'] == 0.0).all() and
            (downloader_data['virus_unique_bigrams.csv'] == 0.0).all() and
            (downloader_data['trojan_unique_bigrams.csv'] == 0.0).all() and
            (downloader_data['worm_unique_bigrams.csv'] == 0.0).all() and
            (downloader_data['downloader_unique_bigrams.csv'] == 0.0).all() and
            (downloader_data['backdoor_unique_bigrams.csv'] == 0.0).all() and
            (downloader_data['benign_unique_bigrams.csv'] == 0.0).all()
        )
    )
]

backdoor_data = backdoor_data[
    ~(
        (
            (backdoor_data['adware_unique_bigrams.csv'] == 0.0).all() and
            (backdoor_data['spyware_unique_bigrams.csv'] == 0.0).all() and
            (backdoor_data['virus_unique_bigrams.csv'] == 0.0).all() and
            (backdoor_data['trojan_unique_bigrams.csv'] == 0.0).all() and
            (backdoor_data['worm_unique_bigrams.csv'] == 0.0).all() and
            (backdoor_data['downloader_unique_bigrams.csv'] == 0.0).all() and
            (backdoor_data['backdoor_unique_bigrams.csv'] == 0.0).all() and
            (backdoor_data['benign_unique_bigrams.csv'] == 0.0).all()
        )
    )
]
benign_data = benign_data[
    ~(
        (
            (benign_data['adware_unique_bigrams.csv'] == 0.0).all() and
            (benign_data['spyware_unique_bigrams.csv'] == 0.0).all() and
            (benign_data['virus_unique_bigrams.csv'] == 0.0).all() and
            (benign_data['trojan_unique_bigrams.csv'] == 0.0).all() and
            (benign_data['worm_unique_bigrams.csv'] == 0.0).all() and
            (benign_data['downloader_unique_bigrams.csv'] == 0.0).all() and
            (benign_data['backdoor_unique_bigrams.csv'] == 0.0).all() and
            (benign_data['benign_unique_bigrams.csv'] == 0.0).all()
        )
    )
]

# Save the DataFrames to new CSV files
adware_data.to_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\column_added\adware.csv', index=False, sep=',')
trojan_data.to_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\column_added\trojan.csv', index=False, sep=',')
worm_data.to_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\column_added\worm.csv', index=False, sep=',')
downloader_data.to_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\column_added\downloader.csv', index=False, sep=',')
backdoor_data.to_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\column_added\backdoor.csv', index=False, sep=',')
spyware_data.to_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\column_added\spyware.csv', index=False, sep=',')
benign_data.to_csv(r'D:\Malware\all_unigram_set_50k\jaccard_similarity\column_added\benign.csv', index=False, sep=',')
