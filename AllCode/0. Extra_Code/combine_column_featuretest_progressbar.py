# -*- coding: utf-8 -*-
"""
Created on Sun Dec 24 20:39:15 2023

@author: Admin
"""

import pandas as pd
from tqdm import tqdm  # Import tqdm for the progress bar

# Define the paths to your CSV files
csv1_path = r'C:\sample\feature_vector\adware.csv'
csv2_path = r'C:\sample\feature_vector\backdoor.csv'

# Read CSV files in chunks
df1 = pd.read_csv(csv1_path)
df2 = pd.read_csv(csv2_path, chunksize=1000)

# Find common columns dynamically
common_columns = list(set(df1.columns) & set(df2.columns))

# Add zero columns for missing columns in df1 and df2
for col in set(df2.columns) - set(df1.columns):
    df1 = pd.concat([df1, pd.DataFrame({col: [0] * len(df1)})], axis=1)

for col in set(df1.columns) - set(df2.columns):
    df2 = pd.concat([df2, pd.DataFrame({col: [0] * len(df2)})], axis=1)

# Reorder columns in df2 to match the order of df1
df2 = df2[df1.columns]

# Initialize the progress bar
total_chunks = len(df2)
pbar = tqdm(total=total_chunks, desc='Merging chunks')

# Append chunks vertically
merged_df = pd.DataFrame()
for chunk1, chunk2 in zip(df1, df2):
    chunk1 = chunk1.reindex(columns=df1.columns, fill_value=0)
    chunk2 = chunk2.reindex(columns=df1.columns, fill_value=0)
    merged_df = merged_df.append(chunk1.append(chunk2), ignore_index=True)
    
    # Update the progress bar
    pbar.update(1)

# Close the progress bar
pbar.close()

# Save the merged dataframe to a new CSV file
merged_df.to_csv(r'C:\sample\feature_vector\combine\adware_backdoor.csv', index=False)
