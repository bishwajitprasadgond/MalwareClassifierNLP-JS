# -*- coding: utf-8 -*-
"""
Created on Wed Dec 20 10:24:09 2023

@author: bishwajit
"""

import csv

def remove_common_lines(input_path1, input_path2, output_path1, output_path2):
    with open(input_path1, 'r', newline='', encoding='utf-8') as csv_file1:
        csv_reader1 = csv.reader(csv_file1)
        lines1 = list(csv_reader1)

    with open(input_path2, 'r', newline='', encoding='utf-8') as csv_file2:
        csv_reader2 = csv.reader(csv_file2)
        lines2 = list(csv_reader2)

    header1 = lines1[0]
    header2 = lines2[0]

    # Check if headers are the same
    if header1 != header2:
        raise ValueError("Headers in the two files are not the same.")

    # Extract data rows (excluding header)
    data1 = [tuple(line) for line in lines1[1:]]
    data2 = [tuple(line) for line in lines2[1:]]

    # Find unique rows in each file
    unique_data1 = [header1] + [list(row) for row in (set(data1) - set(data2))]
    unique_data2 = [header1] + [list(row) for row in (set(data2) - set(data1))]

    # Write unique rows to separate output files
    with open(output_path1, 'w', newline='', encoding='utf-8') as csv_output1:
        csv_writer1 = csv.writer(csv_output1)
        csv_writer1.writerows(unique_data1)

    with open(output_path2, 'w', newline='', encoding='utf-8') as csv_output2:
        csv_writer2 = csv.writer(csv_output2)
        csv_writer2.writerows(unique_data2)

# Example usage:
input_file1 = r'D:\Malware\unigram_analysis\0reduce\virus1.csv'
input_file2 = r'D:\Malware\unigram_analysis\0reduce\worm1.csv'
output_file1 = r'D:\Malware\unigram_analysis\0reduce\virus3.csv'
output_file2 = r'D:\Malware\unigram_analysis\0reduce\worm3.csv'

remove_common_lines(input_file1, input_file2, output_file1, output_file2)
