import pandas as pd
from sklearn.manifold import Isomap
import seaborn as sns
import matplotlib.pyplot as plt
from scipy.sparse import csr_matrix

# Load the CSV file into a DataFrame
data = pd.read_csv('D:\\0malware_analysis\\Combine\\combined_data2.csv', sep=',')

# Extract features and labels
features = data.iloc[:, 1:8]  # Columns 2 to 8 are Jaccard similarity indices
labels = data['label']

# Define the custom color palette for each class
custom_palette = {
    'adware': 'red',
    'backdoor': 'black',
    'downloader': 'green',
    'trojan': 'purple',
    'spyware': 'blue',
    'virus': 'lightgreen',
    'worm': 'orange'
}

# One-hot encode the labels
labels_encoded = pd.get_dummies(labels)

# Convert features to LIL matrix before using Isomap
features_lil = csr_matrix(features.values).tolil()

# Initialize Isomap with two components
isomap = Isomap(n_components=2, n_neighbors=5)

# Fit and transform the data using Isomap
isomap_result = isomap.fit_transform(features_lil)

# Create a DataFrame for the Isomap results
isomap_df = pd.DataFrame(isomap_result, columns=['Isomap Component 1', 'Isomap Component 2'])
isomap_df = pd.concat([isomap_df, labels_encoded], axis=1)

# Plot the Isomap results with the custom color palette
plt.figure(figsize=(10, 8))
sns.scatterplot(x='Isomap Component 1', y='Isomap Component 2', hue=labels, data=isomap_df, palette=custom_palette, s=50)
plt.title('Isomap Visualization of Malware Categories using Jaccard Similarity Indices')
plt.legend(title='Malware Category', loc='upper right')
plt.show()
