# -*- coding: utf-8 -*-
"""
Created on Fri Jun 30 11:53:15 2023

@author: bishwajit
"""


import os
import pandas as pd

def add_excel_files_from_folder(folder_path):
    # Get all file names within the folder
    file_names = os.listdir(folder_path)

    # Filter only Excel files
    excel_files = [file for file in file_names if file.endswith(".xlsx")]

    if not excel_files:
        print("No Excel files found in the folder.")
        return None

    # Read the first file
    first_file_path = os.path.join(folder_path, excel_files[0])
    df = pd.read_excel(first_file_path)

    # Iterate over the remaining files
    for file in excel_files[1:]:
        file_path = os.path.join(folder_path, file)
        # Read the file skipping the first row
        data = pd.read_excel(file_path, skiprows=1)
        # Concatenate the data to the existing DataFrame
        df = pd.concat([df, data], ignore_index=True)

    return df

# Folder path containing the Excel files
folder_path = r"path/to/folder"

# Call the function and get the result
result = add_excel_files_from_folder(folder_path)

if result is not None:
    # Display the combined data
    print(result)
