import pandas as pd
from sklearn.manifold import TSNE
import seaborn as sns
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D  # Importing 3D plotting tools

# Load the CSV file into a DataFrame
data = pd.read_csv('D:\\0malware_analysis\\Combine\\combined_data2.csv', sep=',')

# Extract features and labels
features = data.iloc[:, 1:8]  # Columns 2 to 8 are Jaccard similarity indices
labels = data['label']

# Define the custom color palette for each class
custom_palette = {
    'adware': 'red',
    'backdoor': 'black',
    'downloader': 'green',
    'trojan': 'purple',
    'spyware': 'blue',
    'virus': 'lightgreen',
    'worm': 'orange'
}

# One-hot encode the labels
labels_encoded = pd.get_dummies(labels)

# Initialize t-SNE with three components (for 3D visualization)
tsne = TSNE(n_components=3, random_state=16750)

# Fit and transform the data using t-SNE
tsne_result = tsne.fit_transform(features)

# Create a DataFrame for the t-SNE results
tsne_df = pd.DataFrame(tsne_result, columns=['Dimension 1', 'Dimension 2', 'Dimension 3'])
tsne_df = pd.concat([tsne_df, labels_encoded], axis=1)

# Plot the t-SNE results in 3D with the custom color palette
fig = plt.figure(figsize=(12, 10))
ax = fig.add_subplot(111, projection='3d')

scatter = ax.scatter(xs=tsne_df['Dimension 1'], ys=tsne_df['Dimension 2'], zs=tsne_df['Dimension 3'], c=labels.map(custom_palette), s=20)
legend = ax.legend(handles=scatter.legend_elements()[0], title='Malware Category')
ax.add_artist(legend)

ax.set_xlabel('Dimension 1')
ax.set_ylabel('Dimension 2')
ax.set_zlabel('Dimension 3')
ax.set_title('t-SNE Visualization of Malware Categories using Jaccard Similarity Indices (3D)')

plt.show()
