# -*- coding: utf-8 -*-
"""
Created on Tue Jan 30 13:26:45 2024

@author: BISHWAJIT
"""

import pandas as pd

# Read the CSV file into a DataFrame
df = pd.read_csv(r'C:\Unique_Unigram\benign.csv')

# List of allowed function prefixes
allowed_function_prefixes = [
    'NtClose',
    'NtCreateFile',
    'RegOpenKeyExW',
    'NtOpenKey',
    'RegCloseKey',
    'GetSystemDirectoryW',
    'RegQueryValueExW',
    'GetSystemWindowsDirectoryW',
    'NtOpenSection',
    'SetErrorMode',
    'CoUninitialize',
    'TerminateProcess',
    'MessageBoxW',
    'FormatMessageW',
    'CoCreateInstance',
    'PostQuitMessage',
    'TranslateMessage',
    'GetWindowRect',
    'PostMessageW',
    'FreeEnvironmentStringsA'
]

# Filter rows based on the allowed function prefixes
filtered_df = df[df['Unigram'].apply(lambda x: any(x.startswith(prefix) for prefix in allowed_function_prefixes))]

# Save the new DataFrame to a new CSV file
filtered_df.to_csv(r'C:\Unique_Unigram\filtered_benign.csv', index=False)
