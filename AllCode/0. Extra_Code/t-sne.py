# -*- coding: utf-8 -*-
"""
Created on Mon Nov 13 16:29:26 2023

@author: admin
"""

import pandas as pd
from sklearn.manifold import TSNE
import seaborn as sns
import matplotlib.pyplot as plt

# Load the CSV file into a DataFrame
data = pd.read_csv('D:\\0malware_analysis\\Combine\\combined_data2.csv', sep=',')

# Extract features and labels
features = data.iloc[:, 1:8]  # Columns 2 to 8 are Jaccard similarity indices
labels = data['label']

# Define the custom color palette for each class
custom_palette = {
    'adware': 'red',
    'backdoor': 'black',
    'downloader': 'green',
    'trojan': 'purple',
    'spyware': 'blue',
    'virus': 'lightgreen',
    'worm': 'orange'
}

# One-hot encode the labels
labels_encoded = pd.get_dummies(labels)

# Initialize t-SNE with two components (for 2D visualization)
tsne = TSNE(n_components=3, random_state=16750)

# Fit and transform the data using t-SNE
tsne_result = tsne.fit_transform(features)

# Create a DataFrame for the t-SNE results
tsne_df = pd.DataFrame(tsne_result, columns=['Dimension 1', 'Dimension 2','Dimension 3'])
tsne_df = pd.concat([tsne_df, labels_encoded], axis=1)

# Plot the t-SNE results with the custom color palette
plt.figure(figsize=(10, 8))
sns.scatterplot(x='Dimension 1', y='Dimension 2', hue=labels, data=tsne_df, palette=custom_palette, s=20)
plt.title('t-SNE Visualization of Malware Categories using Jaccard Similarity Indices')
plt.legend(title='Malware Category', loc='upper right')
plt.show()
