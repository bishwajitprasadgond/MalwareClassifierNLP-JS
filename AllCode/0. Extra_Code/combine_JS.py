# -*- coding: utf-8 -*-
"""
Created on Tue Nov 21 22:15:08 2023

@author: Admin
"""

import os
import pandas as pd

def add_csv_files_from_folder(folder_path, save_folder_path):
    # Get all file names within the folder
    file_names = os.listdir(folder_path)

    # Filter only CSV files
    csv_files = [file for file in file_names if file.endswith(".csv")]

    if not csv_files:
        print("No CSV files found in the folder.")
        return None

    # Read the first file
    first_file_path = os.path.join(folder_path, csv_files[0])
    df = pd.read_csv(first_file_path)

    # Iterate over the remaining files
    for file in csv_files[1:]:
        file_path = os.path.join(folder_path, file)
        # Read the file
        data = pd.read_csv(file_path)
        # Concatenate the data to the existing DataFrame
        df = pd.concat([df, data], ignore_index=True)

    # Check if the save folder path exists, if not, create the directory
    if not os.path.exists(save_folder_path):
        os.makedirs(save_folder_path)

    # Save the combined data to a new CSV file
    save_path = os.path.join(save_folder_path, 'combined_data.csv')
    df.to_csv(save_path, index=False)

    return df

# Folder path containing the CSV files
folder_path = r"D:\Malware\trigram_analysis\jaccard_similarity\column_added"

# Specify the folder where the combined CSV file will be saved
save_folder_path = r"D:\Malware\trigram_analysis\jaccard_similarity\Combined"

# Call the function and get the result
result = add_csv_files_from_folder(folder_path, save_folder_path)

if result is not None:
    # Display the combined data
    print(result)
