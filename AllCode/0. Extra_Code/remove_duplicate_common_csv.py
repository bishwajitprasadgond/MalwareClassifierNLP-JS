# -*- coding: utf-8 -*-
"""
Created on Sat Dec  2 14:53:03 2023

@author: Admin
"""

import csv

def remove_common_lines(file1, file2, output_file1, output_file2):
    with open(file1, 'r', newline='', encoding='utf-8') as csv_file1:
        csv_reader1 = csv.reader(csv_file1)
        lines1 = list(csv_reader1)

    with open(file2, 'r', newline='', encoding='utf-8') as csv_file2:
        csv_reader2 = csv.reader(csv_file2)
        lines2 = list(csv_reader2)

    header = lines1[0]  # Assuming both files have the same header

    # Extract data rows (excluding header)
    data1 = set(tuple(line) for line in lines1[1:])
    data2 = set(tuple(line) for line in lines2[1:])

    # Find unique rows in each file
    unique_data1 = data1 - data2
    unique_data2 = data2 - data1

    # Write unique rows to separate output files
    with open(output_file1, 'w', newline='', encoding='utf-8') as csv_output1:
        csv_writer1 = csv.writer(csv_output1)
        csv_writer1.writerow(header)
        csv_writer1.writerows(unique_data1)

    with open(output_file2, 'w', newline='', encoding='utf-8') as csv_output2:
        csv_writer2 = csv.writer(csv_output2)
        csv_writer2.writerow(header)
        csv_writer2.writerows(unique_data2)

# Example usage:
file_paths = {
    'backdoor': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\backdoor_unigram_unique.csv',
    'downloader': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\downloader_unigram_unique.csv',
    'spyware': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\spyware_unigram_unique.csv',
    'trojan': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\trojan_unigram_unique.csv',
    'worm': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\worm_unigram_unique.csv',
    'adware': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\adware_unigram_unique.csv',
    'virus': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\virus_unigram_unique.csv',
}

output_file_paths = {
    'backdoor': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\backdoor.csv',
    'downloader': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\downloader.csv',
    'spyware': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\spyware.csv',
    'trojan': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\trojan.csv',
    'worm': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\worm.csv',
    'adware': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\adware.csv',
    'virus': r'D:\Malware\n_grams\all_unigram_set_50k\unique_unigram\virus.csv',
}

for malware_type in file_paths.keys():
    remove_common_lines(file_paths[malware_type], file_paths['virus'], output_file_paths[malware_type], output_file_paths['virus'])
