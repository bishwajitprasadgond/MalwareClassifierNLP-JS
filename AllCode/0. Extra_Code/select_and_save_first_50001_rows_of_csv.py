# -*- coding: utf-8 -*-
"""
Created on Mon Dec 25 17:03:02 2023

@author: Bishwajit
"""

import os
import pandas as pd

def select_and_save_first_50001_rows(input_folder, output_folder):
    # Create the output folder if it doesn't exist
    if not os.path.exists(output_folder):
        os.makedirs(output_folder)

    # Loop through each CSV file in the input folder
    for filename in os.listdir(input_folder):
        if filename.endswith(".csv"):
            input_filepath = os.path.join(input_folder, filename)
            output_filepath = os.path.join(output_folder, filename)

            # Read the CSV file
            df = pd.read_csv(input_filepath)

            # Select the first 50001 rows
            selected_rows = df.head(50001)

            # Save the selected rows to a new CSV file in the output folder
            selected_rows.to_csv(output_filepath, index=False)

            print(f"Selected and saved 50001 rows from {filename} to {output_filepath}")

# Replace 'input_folder' and 'output_folder' with your actual folder paths
input_folder = r'D:\Malware\unigram_analysis\unique_unigram\unigram'
output_folder = r'D:\Malware\unigram_analysis\unique_unigram\unigram\50k'

select_and_save_first_50001_rows(input_folder, output_folder)
