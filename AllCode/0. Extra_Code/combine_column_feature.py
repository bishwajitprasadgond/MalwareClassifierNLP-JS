import pandas as pd

# Define the paths to your CSV files
csv1_path = r'C:\sample\feature_vector\adware.csv'
csv2_path = r'C:\sample\feature_vector\backdoor.csv'

# Read CSV files into pandas dataframes
df1 = pd.read_csv(csv1_path)
df2 = pd.read_csv(csv2_path)

# Find common columns dynamically
common_columns = list(set(df1.columns) & set(df2.columns))

# Add zero columns for missing columns in df1
missing_cols_df1 = list(set(df2.columns) - set(df1.columns))
for col in missing_cols_df1:
    df1[col] = 0

# Add zero columns for missing columns in df2
missing_cols_df2 = list(set(df1.columns) - set(df2.columns))
for col in missing_cols_df2:
    df2[col] = 0

# Reorder columns in df2 to match the order of df1
df2 = df2[df1.columns]

# Concatenate dataframes vertically
merged_df = pd.concat([df1, df2], ignore_index=True)

# Save the merged dataframe to a new CSV file
merged_df.to_csv(r'C:\sample\feature_vector\combine\adware_backdoor.csv', index=False)
