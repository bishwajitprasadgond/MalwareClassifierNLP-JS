# -*- coding: utf-8 -*-
"""
Created on Mon Dec 25 11:40:48 2023

@author: Bishwajit
"""

import pandas as pd

def drop_columns_with_high_zeros(input_csv_path, output_csv_path):
    # Read the CSV file into a DataFrame
    df = pd.read_csv(input_csv_path)

    # Calculate the percentage of zeros for each column
    zeros_percentage = (df == 0).mean(axis=0)

    # Drop columns with more than 50% zeros
    columns_to_drop = zeros_percentage[zeros_percentage > 0.5].index
    df = df.drop(columns=columns_to_drop)

    # Save the modified DataFrame to a new CSV file
    df.to_csv(output_csv_path, index=False)

# Example usage:
input_csv_path = r"C:\sample\feature_vector\adware.csv"
output_csv_path = r"C:\sample\feature_vector\reduced_feature_vector\adware.csv"

drop_columns_with_high_zeros(input_csv_path, output_csv_path)
