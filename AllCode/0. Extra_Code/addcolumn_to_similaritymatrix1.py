# -*- coding: utf-8 -*-
"""
Created on Fri Nov  3 19:58:45 2023

@author: bishwajit
"""

import pandas as pd

# Load the CSV files into DataFrames
adware_data = pd.read_csv(r'F:\New_fs_jaccard_index\adware_similarity_matrix.csv', sep=',')
trojan_data = pd.read_csv(r'F:\New_fs_jaccard_index\trojan_similarity_matrix.csv', sep=',')
worm_data = pd.read_csv(r'F:\New_fs_jaccard_index\worm_similarity_matrix.csv', sep=',')
downloader_data = pd.read_csv(r'F:\New_fs_jaccard_index\downloader_similarity_matrix.csv', sep=',')
backdoor_data = pd.read_csv(r'F:\New_fs_jaccard_index\backdoor_similarity_matrix.csv', sep=',')
spyware_data = pd.read_csv(r'F:\New_fs_jaccard_index\spyware_similarity_matrix.csv', sep=',')
virus_data = pd.read_csv(r'F:\New_fs_jaccard_index\virus_similarity_matrix.csv', sep=',')

# Add the "label" column based on conditions
def assign_label(row):
    if (
        (row['fs_adware_unique_bigrams.csv'] > 0.0 or
        row['fs_spyware_unique_bigrams.csv'] > 0.0 or
        row['fs_virus_unique_bigrams.csv'] > 0.0 or
        row['fs_trojan_unique_bigrams.csv'] > 0.0 or
        row['fs_worm_unique_bigrams.csv'] > 0.0 or
        row['fs_downloader_unique_bigrams.csv'] > 0.0 or
        row['fs_backdoor_unique_bigrams.csv'] > 0.0)
    ):
        labels = {
            'adware': row['fs_adware_unique_bigrams.csv'],
            'spyware': row['fs_spyware_unique_bigrams.csv'],
            'virus': row['fs_virus_unique_bigrams.csv'],
            'trojan': row['fs_trojan_unique_bigrams.csv'],
            'worm': row['fs_worm_unique_bigrams.csv'],
            'downloader': row['fs_downloader_unique_bigrams.csv'],
            'backdoor': row['fs_backdoor_unique_bigrams.csv']
        }
        return max(labels, key=labels.get)
    else:
        return ''
    



# Assign labels for each DataFrame
adware_data['label'] = adware_data.apply(assign_label, axis=1)
trojan_data['label'] = trojan_data.apply(assign_label, axis=1)
worm_data['label'] = worm_data.apply(assign_label, axis=1)
downloader_data['label'] = downloader_data.apply(assign_label, axis=1)
backdoor_data['label'] = backdoor_data.apply(assign_label, axis=1)
spyware_data['label'] = spyware_data.apply(assign_label, axis=1)
virus_data['label'] = virus_data.apply(assign_label, axis=1)



# Add the "predicted_label" column based on conditions
def assign_predicted_label(row, filename):
    if filename.startswith('adware'):
        return 'adware'
    elif filename.startswith('backdoor'):
        return 'backdoor'
    elif filename.startswith('downloader'):
        return 'downloader'
    elif filename.startswith('trojan'):
        return 'trojan'
    elif filename.startswith('spyware'):
        return 'spyware'
    elif filename.startswith('virus'):
        return 'virus'
    elif filename.startswith('worm'):
        return 'worm'
    else:
        return ''

# Assign labels for "predicted_label" column
adware_data['predicted_label'] = adware_data.apply(lambda x: assign_predicted_label(x, 'adware_similarity_matrix.csv'), axis=1)
trojan_data['predicted_label'] = trojan_data.apply(lambda x: assign_predicted_label(x, 'trojan_similarity_matrix.csv'), axis=1)
worm_data['predicted_label'] = worm_data.apply(lambda x: assign_predicted_label(x, 'worm_similarity_matrix.csv'), axis=1)
downloader_data['predicted_label'] = downloader_data.apply(lambda x: assign_predicted_label(x, 'downloader_similarity_matrix.csv'), axis=1)
backdoor_data['predicted_label'] = backdoor_data.apply(lambda x: assign_predicted_label(x, 'backdoor_similarity_matrix.csv'), axis=1)
spyware_data['predicted_label'] = spyware_data.apply(lambda x: assign_predicted_label(x, 'spyware_similarity_matrix.csv'), axis=1)
virus_data['predicted_label'] = virus_data.apply(lambda x: assign_predicted_label(x, 'virus_similarity_matrix.csv'), axis=1)


# Drop rows where 'label' is empty
adware_data = adware_data[adware_data['label'] != '']
trojan_data = trojan_data[trojan_data['label'] != '']
worm_data = worm_data[worm_data['label'] != '']
downloader_data = downloader_data[downloader_data['label'] != '']
backdoor_data = backdoor_data[backdoor_data['label'] != '']
spyware_data = spyware_data[spyware_data['label'] != '']
virus_data = virus_data[virus_data['label'] != '']

# Drop rows where all columns related to unique bigrams are zero
adware_data = adware_data[
    ~(
        (adware_data[['fs_adware_unique_bigrams.csv',
                      'fs_spyware_unique_bigrams.csv',
                      'fs_virus_unique_bigrams.csv',
                      'fs_trojan_unique_bigrams.csv',
                      'fs_worm_unique_bigrams.csv',
                      'fs_downloader_unique_bigrams.csv',
                      'fs_backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

trojan_data = trojan_data[
    ~(
        (trojan_data[['fs_adware_unique_bigrams.csv',
                      'fs_spyware_unique_bigrams.csv',
                      'fs_virus_unique_bigrams.csv',
                      'fs_trojan_unique_bigrams.csv',
                      'fs_worm_unique_bigrams.csv',
                      'fs_downloader_unique_bigrams.csv',
                      'fs_backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

worm_data = worm_data[
    ~(
        (worm_data[['fs_adware_unique_bigrams.csv',
                      'fs_spyware_unique_bigrams.csv',
                      'fs_virus_unique_bigrams.csv',
                      'fs_trojan_unique_bigrams.csv',
                      'fs_worm_unique_bigrams.csv',
                      'fs_downloader_unique_bigrams.csv',
                      'fs_backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

downloader_data = downloader_data[
    ~(
        (downloader_data[['fs_adware_unique_bigrams.csv',
                      'fs_spyware_unique_bigrams.csv',
                      'fs_virus_unique_bigrams.csv',
                      'fs_trojan_unique_bigrams.csv',
                      'fs_worm_unique_bigrams.csv',
                      'fs_downloader_unique_bigrams.csv',
                      'fs_backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

backdoor_data = backdoor_data[
    ~(
        (backdoor_data[['fs_adware_unique_bigrams.csv',
                      'fs_spyware_unique_bigrams.csv',
                      'fs_virus_unique_bigrams.csv',
                      'fs_trojan_unique_bigrams.csv',
                      'fs_worm_unique_bigrams.csv',
                      'fs_downloader_unique_bigrams.csv',
                      'fs_backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

spyware_data = spyware_data[
    ~(
        (spyware_data[['fs_adware_unique_bigrams.csv',
                      'fs_spyware_unique_bigrams.csv',
                      'fs_virus_unique_bigrams.csv',
                      'fs_trojan_unique_bigrams.csv',
                      'fs_worm_unique_bigrams.csv',
                      'fs_downloader_unique_bigrams.csv',
                      'fs_backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

virus_data = virus_data[
    ~(
        (virus_data[['fs_adware_unique_bigrams.csv',
                      'fs_spyware_unique_bigrams.csv',
                      'fs_virus_unique_bigrams.csv',
                      'fs_trojan_unique_bigrams.csv',
                      'fs_worm_unique_bigrams.csv',
                      'fs_downloader_unique_bigrams.csv',
                      'fs_backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]



# Save the DataFrames to new CSV files
adware_data.to_csv(r'F:\New_fs_jaccard_index\similarity_matrix_columnadded\adware_classify.csv', index=False, sep=',')
trojan_data.to_csv(r'F:\New_fs_jaccard_index\similarity_matrix_columnadded\trojan_classify.csv', index=False, sep=',')
worm_data.to_csv(r'F:\New_fs_jaccard_index\similarity_matrix_columnadded\worm_classify.csv', index=False, sep=',')
downloader_data.to_csv(r'F:\New_fs_jaccard_index\similarity_matrix_columnadded\downloader_classify.csv', index=False, sep=',')
backdoor_data.to_csv(r'F:\New_fs_jaccard_index\similarity_matrix_columnadded\backdoor_classify.csv', index=False, sep=',')
spyware_data.to_csv(r'F:\New_fs_jaccard_index\similarity_matrix_columnadded\spyware_classify.csv', index=False, sep=',')
virus_data.to_csv(r'F:\New_fs_jaccard_index\similarity_matrix_columnadded\virus_classify.csv', index=False, sep=',')
