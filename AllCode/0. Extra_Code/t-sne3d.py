# -*- coding: utf-8 -*-
"""
Created on Mon Nov 13 21:19:47 2023

@author: admin
"""

import pandas as pd
from sklearn.manifold import TSNE
import seaborn as sns
import matplotlib.pyplot as plt
from mpl_toolkits.mplot3d import Axes3D  # Importing 3D plotting tools

# Load the CSV file into a DataFrame
data = pd.read_csv('D:\\0malware_analysis\\Combine\\combined_data2.csv', sep=',')

# Extract features and labels
features = data.iloc[:, 1:8]  # Columns 2 to 8 are Jaccard similarity indices
labels = data['label']

# Define the custom color palette for each class
custom_palette = {
    'adware': 'red',
    'backdoor': 'black',
    'downloader': 'green',
    'trojan': 'purple',
    'spyware': 'blue',
    'virus': 'lightgreen',
    'worm': 'orange'
}

# One-hot encode the labels
labels_encoded = pd.get_dummies(labels)

# Initialize t-SNE with three components (for 3D visualization)
tsne = TSNE(n_components=3, random_state=16750)

# Fit and transform the data using t-SNE
tsne_result = tsne.fit_transform(features)

# Create a DataFrame for the t-SNE results
tsne_df = pd.DataFrame(tsne_result, columns=['Dimension 1', 'Dimension 2', 'Dimension 3'])
tsne_df = pd.concat([tsne_df, labels_encoded], axis=1)

# Plot the t-SNE results in 3D with the custom color palette
fig = plt.figure(figsize=(12, 10))
ax = fig.add_subplot(111, projection='3d')

for label, color in custom_palette.items():
    class_data = tsne_df[tsne_df[label] == 1]
    scatter = ax.scatter(xs=class_data['Dimension 1'], ys=class_data['Dimension 2'], zs=class_data['Dimension 3'], c=color, label=label, s=5)

ax.set_xlabel('Dimension 1')
ax.set_ylabel('Dimension 2')
ax.set_zlabel('Dimension 3')
ax.set_title('t-SNE Visualization of Malware Categories using Jaccard Similarity Indices (3D)')

ax.legend(title='Malware Category', loc='upper right')

plt.show()
