# -*- coding: utf-8 -*-
"""
Created on Tue Dec 26 11:16:18 2023

@author: Bishwajit
"""

import os
import pandas as pd

# List to store skipped file names
skipped_files = []


name = 'benign'

file1_path = r'C:\sample\mal_classes\\' + name + '_unigram_created'

# List of all CSV files
#file1_path = r'F:\sample\mal_classes\virus_unigram_created'
# Output CSV
output_csv_path = r'C:\sample\mal_classes\\' + name + '_unigram_created_1000.csv'

# Iterate through all CSV files in file1_path
for file1_file_name in os.listdir(file1_path):
    file1_full_path = os.path.join(file1_path, file1_file_name)

    # Check if the file is empty or has rows less than or equal to 1000
    if os.path.getsize(file1_full_path) == 0 or len(pd.read_csv(file1_full_path, skiprows=1)) <= 1000:
        print(f"Skipping empty or small file: {file1_file_name}")
        skipped_files.append(file1_file_name)

# Export the list of skipped files to a CSV file
skipped_files_df = pd.DataFrame(skipped_files, columns=["Skipped Files"])
skipped_files_df = skipped_files_df.drop_duplicates()  # Drop duplicates
skipped_files_df.to_csv(output_csv_path, index=False)

# Create a new folder for moved files
new_folder_path = r'C:\sample\mal_classes\moved_'+ name +'_unigram_created'
os.makedirs(new_folder_path, exist_ok=True)

# Iterate through all CSV files in file1_path
for file1_file_name in skipped_files_df["Skipped Files"]:
    file1_full_path = os.path.join(file1_path, file1_file_name)

    # Move the file to the new folder
    new_file_path = os.path.join(new_folder_path, file1_file_name)
    os.rename(file1_full_path, new_file_path)

print("Files moved successfully.")
