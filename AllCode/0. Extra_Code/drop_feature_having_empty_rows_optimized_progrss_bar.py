# -*- coding: utf-8 -*-
"""
Created on Mon Dec 25 11:40:48 2023

@author: Bishwajit
"""

import pandas as pd
from tqdm import tqdm

def drop_columns_with_high_zeros(input_csv_path, output_csv_path):
    # Read the CSV file into a DataFrame
    df = pd.read_csv(input_csv_path)

    # Initialize tqdm with the number of columns
    progress_bar = tqdm(total=len(df.columns), desc="Processing Columns")

    # Iterate through columns
    for column in df.columns:
        # Calculate the percentage of zeros for the current column
        zeros_percentage = (df[column] == 0).mean()

        # Drop the column if more than 50% zeros
        if zeros_percentage > 0.5:
            df = df.drop(columns=column)
            progress_bar.set_postfix({"Dropped Columns": progress_bar.n - 1})
        progress_bar.update()

    progress_bar.close()

    # Save the modified DataFrame to a new CSV file
    df.to_csv(output_csv_path, index=False)

# Example usage:
input_csv_path = r"C:\sample\feature_vector\adware50k.csv"
output_csv_path = r"C:\sample\feature_vector\reduced_feature_vector\adware.csv"

drop_columns_with_high_zeros(input_csv_path, output_csv_path)
