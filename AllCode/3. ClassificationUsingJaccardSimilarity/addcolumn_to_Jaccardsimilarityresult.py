# -*- coding: utf-8 -*-
"""
Created on Fri Nov  3 19:58:45 2023

@author: bishwajit
"""

import pandas as pd

# Load the CSV files into DataFrames
adware_data = pd.read_csv(r'G:\new_malware_json_zip\split_data\adware_similarity_matrix.csv', sep=',')
trojan_data = pd.read_csv(r'G:\new_malware_json_zip\split_data\trojan_similarity_matrix.csv', sep=',')
worm_data = pd.read_csv(r'G:\new_malware_json_zip\split_data\worm_similarity_matrix.csv', sep=',')
downloader_data = pd.read_csv(r'G:\new_malware_json_zip\split_data\downloader_similarity_matrix.csv', sep=',')
backdoor_data = pd.read_csv(r'G:\new_malware_json_zip\split_data\backdoor_similarity_matrix.csv', sep=',')
spyware_data = pd.read_csv(r'G:\new_malware_json_zip\split_data\spyware_similarity_matrix.csv', sep=',')
virus_data = pd.read_csv(r'G:\new_malware_json_zip\split_data\virus_similarity_matrix.csv', sep=',')

# Add the "label" column based on conditions
def assign_label(row):
    if (
        (row['adware_unique_bigrams.csv'] > 0.0 or
        row['spyware_unique_bigrams.csv'] > 0.0 or
        row['virus_unique_bigrams.csv'] > 0.0 or
        row['trojan_unique_bigrams.csv'] > 0.0 or
        row['worm_unique_bigrams.csv'] > 0.0 or
        row['downloader_unique_bigrams.csv'] > 0.0 or
        row['backdoor_unique_bigrams.csv'] > 0.0)
    ):
        labels = {
            'adware': row['adware_unique_bigrams.csv'],
            'spyware': row['spyware_unique_bigrams.csv'],
            'virus': row['virus_unique_bigrams.csv'],
            'trojan': row['trojan_unique_bigrams.csv'],
            'worm': row['worm_unique_bigrams.csv'],
            'downloader': row['downloader_unique_bigrams.csv'],
            'backdoor': row['backdoor_unique_bigrams.csv']
        }
        return max(labels, key=labels.get)
    else:
        return ''

# Assign labels for each DataFrame
adware_data['label'] = adware_data.apply(assign_label, axis=1)
trojan_data['label'] = trojan_data.apply(assign_label, axis=1)
worm_data['label'] = worm_data.apply(assign_label, axis=1)
downloader_data['label'] = downloader_data.apply(assign_label, axis=1)
backdoor_data['label'] = backdoor_data.apply(assign_label, axis=1)
spyware_data['label'] = spyware_data.apply(assign_label, axis=1)
virus_data['label'] = virus_data.apply(assign_label, axis=1)

# Drop rows where 'label' is empty
adware_data = adware_data[adware_data['label'] != '']
trojan_data = trojan_data[trojan_data['label'] != '']
worm_data = worm_data[worm_data['label'] != '']
downloader_data = downloader_data[downloader_data['label'] != '']
backdoor_data = backdoor_data[backdoor_data['label'] != '']
spyware_data = spyware_data[spyware_data['label'] != '']
virus_data = virus_data[virus_data['label'] != '']

# Drop rows where all columns related to unique bigrams are zero
adware_data = adware_data[
    ~(
        (adware_data[['adware_unique_bigrams.csv',
                      'spyware_unique_bigrams.csv',
                      'virus_unique_bigrams.csv',
                      'trojan_unique_bigrams.csv',
                      'worm_unique_bigrams.csv',
                      'downloader_unique_bigrams.csv',
                      'backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

trojan_data = trojan_data[
    ~(
        (trojan_data[['adware_unique_bigrams.csv',
                      'spyware_unique_bigrams.csv',
                      'virus_unique_bigrams.csv',
                      'trojan_unique_bigrams.csv',
                      'worm_unique_bigrams.csv',
                      'downloader_unique_bigrams.csv',
                      'backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

worm_data = worm_data[
    ~(
        (worm_data[['adware_unique_bigrams.csv',
                     'spyware_unique_bigrams.csv',
                     'virus_unique_bigrams.csv',
                     'trojan_unique_bigrams.csv',
                     'worm_unique_bigrams.csv',
                     'downloader_unique_bigrams.csv',
                     'backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

downloader_data = downloader_data[
    ~(
        (downloader_data[['adware_unique_bigrams.csv',
                           'spyware_unique_bigrams.csv',
                           'virus_unique_bigrams.csv',
                           'trojan_unique_bigrams.csv',
                           'worm_unique_bigrams.csv',
                           'downloader_unique_bigrams.csv',
                           'backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

backdoor_data = backdoor_data[
    ~(
        (backdoor_data[['adware_unique_bigrams.csv',
                         'spyware_unique_bigrams.csv',
                         'virus_unique_bigrams.csv',
                         'trojan_unique_bigrams.csv',
                         'worm_unique_bigrams.csv',
                         'downloader_unique_bigrams.csv',
                         'backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

spyware_data = spyware_data[
    ~(
        (spyware_data[['adware_unique_bigrams.csv',
                         'spyware_unique_bigrams.csv',
                         'virus_unique_bigrams.csv',
                         'trojan_unique_bigrams.csv',
                         'worm_unique_bigrams.csv',
                         'downloader_unique_bigrams.csv',
                         'backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

virus_data = virus_data[
    ~(
        (virus_data[['adware_unique_bigrams.csv',
                         'spyware_unique_bigrams.csv',
                         'virus_unique_bigrams.csv',
                         'trojan_unique_bigrams.csv',
                         'worm_unique_bigrams.csv',
                         'downloader_unique_bigrams.csv',
                         'backdoor_unique_bigrams.csv']] == 0.0).all(axis=1)
    )
]

# Save the DataFrames to new CSV files
adware_data.to_csv(r'G:\new_malware_json_zip\split_data\adware_classify.csv', index=False, sep=',')
trojan_data.to_csv(r'G:\new_malware_json_zip\split_data\trojan_classify.csv', index=False, sep=',')
worm_data.to_csv(r'G:\new_malware_json_zip\split_data\worm_classify.csv', index=False, sep=',')
downloader_data.to_csv(r'G:\new_malware_json_zip\split_data\downloader_classify.csv', index=False, sep=',')
backdoor_data.to_csv(r'G:\new_malware_json_zip\split_data\backdoor_classify.csv', index=False, sep=',')
spyware_data.to_csv(r'G:\new_malware_json_zip\split_data\spyware_classify.csv', index=False, sep=',')
virus_data.to_csv(r'G:\new_malware_json_zip\split_data\virus_classify.csv', index=False, sep=',')
